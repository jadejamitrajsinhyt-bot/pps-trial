<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fibonacci Series Trial</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Set a nice, modern font (Inter is default with Tailwind) -->
    <style>
        /* Define the keyframes for the new "Fly-in and Blast" animation */
        @keyframes fly-in-blast {
            /* Start off screen left, small, invisible */
            0% { opacity: 0; transform: translateX(-100vw) scale(0.1); filter: brightness(1); }
            
            /* Mid-way, arriving at position, fully visible */
            50% { opacity: 1; transform: translateX(0) scale(1); filter: brightness(1.5); }
            
            /* Blast/Shake Effect - Brief flash of light and small shake */
            70% { transform: scale(1.1) rotate(1deg); filter: brightness(2.5); }
            80% { transform: scale(1) rotate(-1deg); filter: brightness(1.5); }
            90% { transform: scale(1.05) rotate(0.5deg); filter: brightness(1); }
            
            /* Final state */
            100% { opacity: 1; transform: scale(1) rotate(0); filter: brightness(1); }
        }
        /* Apply the new animation to the header */
        .header-animate {
            animation: fly-in-blast 3s ease-in-out 1; /* Longer duration for the desired effect */
        }

        /* Define the keyframes for the error pop-up in the code box */
        @keyframes error-pop-blink {
            0% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.02); }
            100% { opacity: 1; transform: scale(1); }
        }
        .code-error-animate {
            animation: error-pop-blink 0.5s ease-in-out 1;
            font-weight: bold;
        }

    </style>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center p-4">

    <!-- Main Container: Centered, white, rounded card with shadow -->
    <div class="max-w-4xl w-full bg-white p-8 md:p-12 rounded-2xl shadow-2xl space-y-8">

        <!-- 1. Main Header Title: Fly-in and Blast animation -->
        <h1 id="main-header" class="text-4xl sm:text-5xl md:text-6xl font-extrabold text-blue-700 text-center tracking-tight header-animate transition duration-300">
            Fibonacci Series Trial
        </h1>

        <!-- 2. Sub-heading -->
        <h2 class="text-lg sm:text-xl md:text-2xl font-semibold text-gray-600 text-center mt-6 p-2 rounded-lg bg-blue-50">
            LET'S TRY TO ADD AND REMOVE NUMBERS TO IDENTIFY FIBONACCI SERIES
        </h2>

        <!-- Controls Area -->
        <div class="flex flex-wrap justify-center gap-3">
            <!-- Listener added in script -->
            <input type="number" id="number-input" placeholder="Enter a number (e.g., 1, 1, 2, 3...)"
                   class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 shadow-md transition duration-150 min-w-[180px] md:min-w-0">
            
            <!-- Listener added in script -->
            <button id="add-button"
                    class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                Add Number
            </button>
            
            <!-- Listener added in script -->
            <button id="edit-button"
                    class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                Edit Series
            </button>
            
            <!-- Listener added in script -->
            <button id="check-button"
                    class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                Check Series
            </button>
            <!-- Listener added in script -->
            <button id="reset-button"
                    class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105">
                Reset
            </button>
        </div>

        <!-- Fibonacci Logic Note -->
        <div class="text-center bg-yellow-50 p-3 rounded-lg border border-yellow-200 text-yellow-800 font-semibold text-sm shadow-inner">
            NOTE: Fibonacci Logic: Each number is the sum of the two preceding ones. (e.g., 0, 1, 1, 2, 3, 5...)
        </div>

        <!-- 3. The designated white box for interaction (Display Area) -->
        <div id="series-box" class="w-full min-h-48 bg-gray-50 border-4 border-dashed border-gray-300 rounded-xl p-6 transition-all duration-500 shadow-inner">
            <div id="current-series" class="flex flex-wrap items-center min-h-12">
                <!-- Numbers will appear here as clickable chips -->
            </div>
            
            <!-- Message area is now text-lg for smaller size -->
            <div id="message-area" class="mt-4 text-center font-bold text-lg min-h-6">
                <!-- Status messages will appear here -->
            </div>
        </div>
        
        <!-- 4. C Code Compiler Display Box (Black Box) -->
        <div id="code-compiler-box" class="w-full bg-gray-900 text-white p-6 rounded-xl shadow-2xl font-mono mt-6">
            <div class="font-bold mb-3 border-b border-gray-700 pb-2">C Series Code Output:</div>
            <pre id="c-code-output" class="whitespace-pre-wrap text-sm text-green-400">
PUT MIN 2 VALUES ABOVE TO SHOW FIBONACCI SERIES
            </pre>
        </div>

        <!-- Removed Instruction Area - Now a blank spacer -->
        <div class="pt-4 mb-4">
            <!-- Blank space as requested -->
        </div>
        
        <!-- Bottom Section for Logos and Design Credit - SMALLER FOOTER -->
        <div class="flex justify-between items-center mt-6 pt-4 border-t border-gray-200">
            
            <!-- Left Logo (Gardi Vidyapith) - Using external URL -->
            <img src="https://universitykart.b-cdn.net/Content/upload/admin/ljttqutu.5w1.jfif" 
                 onerror="this.onerror=null;this.src='https://placehold.co/64x64/000000/FFFFFF?text=Gardi';"
                 alt="Gardi Vidyapith Logo" 
                 class="h-12 w-12 md:h-16 md:w-16 object-contain shrink-0">
            
            <!-- Center Text - Glow effect on hover -->
            <p class="text-center text-xs sm:text-sm md:text-base font-extrabold italic 
                      bg-yellow-200 p-1 rounded-md shadow-inner text-gray-800 mx-4 shrink
                      /* Glow effect via hover:scale, hover:shadow, and color change */
                      transition duration-300 transform hover:scale-105 hover:shadow-xl hover:text-yellow-900 hover:bg-yellow-300 cursor-pointer"> 
                DESIGNED BY MITRAJ & BHARGAV
            </p>

            <!-- Right Logo (GTU) - Using new external URL, perfectly visible -->
            <img src="https://yt3.ggpht.com/a/AATXAJwkzcPWXydysxnX_80Og5aHV64bmO9hStKvlg=s900-c-k-c0xffffffff-no-rj-mo"
                 onerror="this.onerror=null;this.src='https://placehold.co/64x64/000000/FFFFFF?text=GTU';"
                 alt="Gujarat Technological University Logo" 
                 class="h-12 w-12 md:h-16 md:w-16 object-contain shrink-0">
        </div>
        
    </div>

    <script>
        // State variable to hold the series numbers
        let series = [];
        let isEditMode = false; // Tracks if editing is enabled
        
        // DOM element references (Defined globally but retrieved within init)
        let seriesDisplay;
        let numberInput;
        let messageArea;
        let editButton;
        let cCodeOutput;

        const LOGIC_ERROR_MESSAGE = 'PUT CORECT VALUES ABOVE TO MAKE A FIBONACCI SERIES CODE';
        const SHORT_SERIES_MESSAGE = 'PUT MIN 2 VALUES ABOVE TO SHOW FIBONACCI SERIES';

        // --- CORE FUNCTIONS ---

        // Helper function to reset the code output box to its initial (short series) state
        function resetCodeOutput() {
            cCodeOutput.textContent = SHORT_SERIES_MESSAGE;
            cCodeOutput.className = 'whitespace-pre-wrap text-sm text-green-400';
            cCodeOutput.classList.remove('code-error-animate', 'text-red-400');
        }

        // Function to toggle the editing mode
        function toggleEditMode() {
            isEditMode = !isEditMode;
            updateDisplay();
            
            // If exiting edit mode, reset the code output
            if (!isEditMode) {
                resetCodeOutput();
            }

            if (isEditMode) {
                editButton.classList.remove('bg-yellow-500', 'hover:bg-yellow-600');
                editButton.classList.add('bg-orange-600', 'hover:bg-orange-700');
                editButton.textContent = 'Exit Edit Mode';
                showMessage("Editing enabled. Click a number to remove it.", "text-orange-600");
            } else {
                editButton.classList.remove('bg-orange-600', 'hover:bg-orange-700');
                editButton.classList.add('bg-yellow-500', 'hover:bg-yellow-600');
                editButton.textContent = 'Edit Series';
                showMessage("Editing disabled.", "text-gray-500");
            }
        }

        // Function to remove a number by its index (used when clicking a number chip)
        function removeNumberByIndex(index) {
            if (!isEditMode) {
                return; 
            }

            if (index >= 0 && index < series.length) {
                const removed = series.splice(index, 1)[0];
                updateDisplay();
                showMessage(`Removed ${removed} from the series.`, "text-yellow-700");
                messageArea.textContent = '';
                resetCodeOutput(); // Reset code output on removal
            }
        }

        // Function to update the display area with clickable chips
        function updateDisplay() {
            if (series.length === 0) {
                seriesDisplay.innerHTML = '<p class="text-gray-400 text-lg italic select-none">Start adding numbers above...</p>';
            } else {
                const baseClasses = "inline-flex items-center text-blue-800 text-3xl font-mono font-bold px-4 py-2 mr-2 mb-2 rounded-full shadow-md transition duration-150 active:scale-95";

                seriesDisplay.innerHTML = series.map((number, index) => {
                    let chipClasses = baseClasses;
                    let clickAction = '';
                    let title = '';

                    // The inline onclick handler is acceptable here because these elements are dynamically created 
                    // within the script and the function `removeNumberByIndex` is in the global scope.
                    if (isEditMode) {
                        chipClasses += " bg-red-100 cursor-pointer hover:bg-red-300 hover:text-red-900";
                        clickAction = `onclick="removeNumberByIndex(${index})"`;
                        title = 'title="Click to remove this number"';
                    } else {
                        chipClasses += " bg-blue-100 select-none";
                        title = 'title="Click Edit Series to enable removal"';
                    }

                    return `
                        <span ${clickAction} ${title} class="${chipClasses}">
                            ${number}
                            ${isEditMode ? `
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4 ml-2">
                                  <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z" />
                                </svg>` 
                            : ''}
                        </span>
                    `;
                }).join('');
            }
        }

        // Function to generate C code representation of the verified series
        function generateCCode(fibSeries) {
            let code = `#include <stdio.h>\n\n`;
            code += `int main() {\n`;

            if (fibSeries.length === 0) {
                code += `    printf("Series is empty.\\n");\n`;
            } else {
                const seriesString = fibSeries.join(', ');
                const len = fibSeries.length;
                
                code += `    // User-validated Fibonacci series of length ${len}\n`;
                code += `    int series[${len}] = {${seriesString}};\n\n`;
                code += `    printf("Verified Fibonacci Series: ");\n`;

                code += `    for (int i = 0; i < ${len}; i++) {\n`;
                code += `        printf("%d", series[i]);\n`;
                code += `        if (i < ${len} - 1) {\n`;
                code += `            printf(", ");\n`;
                code += `        }\n`;
                code += `    }\n`;
                code += `    printf("\\n");\n`;
            }
            
            code += `    return 0;\n`;
            code += `}`;
            return code;
        }


        // Function to add a number to the series
        function addNumber() {
            if (isEditMode) {
                toggleEditMode();
            }

            const value = numberInput.value.trim();
            const number = Math.floor(parseInt(value, 10));

            if (value === '' || isNaN(number) || number < 0) {
                showMessage("Please enter a valid positive whole number.", "text-yellow-600");
                return;
            }
            
            series.push(number);
            updateDisplay();

            numberInput.value = '';
            numberInput.focus();
            showMessage(`Added ${number}. Current length: ${series.length}`, "text-gray-500");

            messageArea.textContent = '';
            // Reset code output when a number is added
            resetCodeOutput(); 
        }

        // Function to check if the current series is Fibonacci
        function checkFibonacci() {
            if (isEditMode) {
                toggleEditMode();
            }

            // Check 1: Minimum length for C code output prompt (user requested min 2)
            if (series.length < 2) {
                showMessage("A series needs at least 2 numbers for code consideration.", "text-red-600");
                cCodeOutput.textContent = SHORT_SERIES_MESSAGE;
                cCodeOutput.className = 'whitespace-pre-wrap text-sm text-red-400';
                updateDisplay();
                return;
            }

            // Check 2: Minimum length for mathematical Fibonacci validation (must be 3)
            if (series.length < 3) {
                showMessage("A Fibonacci sequence needs at least 3 numbers to be checked.", "text-orange-600");
                // Although not mathematically validated, we can still show the logic error message
                cCodeOutput.textContent = LOGIC_ERROR_MESSAGE;
                cCodeOutput.className = 'whitespace-pre-wrap text-sm text-red-400 code-error-animate'; 
                updateDisplay();
                // Remove animation class after it runs once
                setTimeout(() => {
                    cCodeOutput.classList.remove('code-error-animate');
                }, 500);
                return;
            }


            let isFib = true;
            for (let i = 2; i < series.length; i++) {
                if (series[i] !== series[i - 1] + series[i - 2]) {
                    isFib = false;
                    break;
                }
            }

            if (isFib) {
                showMessage("Success! This is a correct Fibonacci series!", "text-green-700 bg-green-100 p-2 rounded-lg");
                cCodeOutput.textContent = generateCCode(series); 
                cCodeOutput.className = 'whitespace-pre-wrap text-sm text-green-400'; // Success color
            } else {
                showMessage("Incorrect. This is NOT a Fibonacci series.", "text-red-700 bg-red-100 p-2 rounded-lg");
                
                // Series is wrong (logic error), apply red and animation
                cCodeOutput.textContent = LOGIC_ERROR_MESSAGE;
                cCodeOutput.className = 'whitespace-pre-wrap text-sm text-red-400 code-error-animate'; 

                // Remove animation class after it runs once
                setTimeout(() => {
                    cCodeOutput.classList.remove('code-error-animate');
                }, 500);
            }
            updateDisplay(); 
        }

        // Function to reset the series
        function resetSeries() {
            if (isEditMode) {
                toggleEditMode();
            }
            
            series = [];
            updateDisplay();
            numberInput.value = '';
            numberInput.focus();
            showMessage("Series has been reset.", "text-gray-700");
            resetCodeOutput(); // Reset code output
        }

        // Helper function to show temporary messages
        function showMessage(msg, classes) {
            messageArea.className = `mt-4 text-center font-bold text-lg min-h-6 ${classes}`; 
            messageArea.textContent = msg;

            setTimeout(() => {
                if (messageArea.textContent === msg) {
                    messageArea.textContent = '';
                    messageArea.className = "mt-4 text-center font-bold text-lg min-h-6"; 
                }
            }, 4000);
        }
        
        // --- Initialization and Event Attachments ---

        function initApp() {
            // Get DOM elements
            seriesDisplay = document.getElementById('current-series');
            numberInput = document.getElementById('number-input');
            messageArea = document.getElementById('message-area');
            editButton = document.getElementById('edit-button');
            cCodeOutput = document.getElementById('c-code-output');

            // Attach Event Listeners
            document.getElementById('add-button').addEventListener('click', addNumber);
            document.getElementById('edit-button').addEventListener('click', toggleEditMode);
            document.getElementById('check-button').addEventListener('click', checkFibonacci);
            document.getElementById('reset-button').addEventListener('click', resetSeries);
            
            // Handle Enter keypress on the input field
            numberInput.addEventListener('keydown', (event) => {
                if (event.key === 'Enter') {
                    addNumber();
                }
            });

            // Initial setup when the page loads
            updateDisplay();
            resetCodeOutput(); 
        }

        // Wait for the entire DOM content to load before initializing the app
        window.addEventListener('load', initApp);
    </script>
</body>

</html>
